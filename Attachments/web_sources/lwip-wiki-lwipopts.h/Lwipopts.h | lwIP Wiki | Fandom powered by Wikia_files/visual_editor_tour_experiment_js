
define('ext.wikia.spitfires.experiments.tracker',['wikia.tracker','wikia.abTest','wikia.cookies'],function(tracker,abTest,cookies){'use strict';var track=tracker.buildTrackingFunction({category:'spitfires-contribution-experiments',trackingMethod:'analytics'});function trackVerboseClick(experiment,label){trackClick(prepareStructuredLabel(experiment,label));}
function trackVerboseImpression(experiment,label){trackImpression(prepareStructuredLabel(experiment,label));}
function trackVerboseSuccess(experiment,label){trackSuccess(prepareStructuredLabel(experiment,label));}
function trackClick(label){track({action:tracker.ACTIONS.CLICK,label:label});}
function trackImpression(label){track({action:tracker.ACTIONS.IMPRESSION,label:label});}
function trackSuccess(label){track({action:tracker.ACTIONS.SUCCESS,label:label});}
function getUserStatus(){if(cookies.get('newlyregistered')){return'newlyregistered';}else if(cookies.get('userwithoutedit')){return'userwithoutedit';}else{return'userStatusNaN';}}
function prepareStructuredLabel(experiment,label){var userStatusLabel=getUserStatus();return[experiment,userStatusLabel,label].join('-');}
return{trackVerboseClick:trackVerboseClick,trackVerboseImpression:trackVerboseImpression,trackVerboseSuccess:trackVerboseSuccess};});;define('VisualEditorTourExperiment',['jquery','wikia.loader','wikia.mustache','mw','ext.wikia.spitfires.experiments.tracker'],function($,loader,mustache,mw,tracker){'use strict';var EXPERIMENT_NAME='contribution-experiments';function Tour(tourConfig){this.tourConfig=tourConfig;this.steps=[];}
Tour.prototype.start=function(){this.step=-1;loader({type:loader.MULTI,resources:{mustache:'extensions/wikia/VisualEditorTourExperiment/templates/'+'VisualEditorTourExperiment_content.mustache'}}).done(this._setupTour.bind(this));};Tour.prototype.destroyStep=function(step){var tourStepData=this.steps[step],$element=tourStepData?tourStepData.$element:null;if($element){$element.popover('destroy');}};Tour.prototype.openStep=function(step){var tourStepData=this.steps[step],$element=tourStepData?tourStepData.$element:null;if(!$element){return;}
$element.popover({content:tourStepData.content,html:true,placement:this.tourConfig[step].placement,trigger:'manual',template:'<div class="popover ve-tour">'+'<div class="arrow"></div>'+'<div class="popover-inner">'+'<div class="popover-content"></div>'+'</div>'+'</div>'});$element.popover('show');tracker.trackVerboseImpression(EXPERIMENT_NAME,'tour-step-'+this.step);};Tour.prototype.nextHandle=function(){this._setDisabled();this.next();tracker.trackVerboseClick(EXPERIMENT_NAME,'next-go-to-'+this.step);};Tour.prototype.next=function(){if(this.step===this.steps.length-1){this.destroyStep(this.step);tracker.trackVerboseClick(EXPERIMENT_NAME,'tour-complete');return;}
this.destroyStep(this.step);this.openStep(++this.step);};Tour.prototype.prevHandle=function(){this.destroyStep(this.step);this.openStep(--this.step);tracker.trackVerboseClick(EXPERIMENT_NAME,'next-go-to-'+this.step);};Tour.prototype.close=function(){this._setDisabled();this.destroyStep(this.step);tracker.trackVerboseClick(EXPERIMENT_NAME,'close-'+this.step);};Tour.prototype._setDisabled=function(){if(!$.cookie('vetourdisabled')){$.cookie('vetourdisabled',1,{expires:30,path:mw.config.get('wgCookiePath'),domain:mw.config.get('wgCookieDomain')});}};Tour.prototype._setupTour=function(assets){var $body=$('body');mw.hook('ve.cancelButton').add(function(){$body.off('.VETour');this.destroyStep(this.step);}.bind(this));$body.on('click.VETour','.ve-tour-next',this.nextHandle.bind(this));$body.on('click.VETour','.ve-tour-prev',this.prevHandle.bind(this));$body.on('click.VETour','.ve-tour-experiment .close',this.close.bind(this));this.contentTemplate=assets.mustache[0];this.tourConfig.forEach(this._setupStep.bind(this));setTimeout(this.next.bind(this),200);};Tour.prototype._setupStep=function(item,id){var buttonLabel=id===this.tourConfig.length-1?'編集を開始':'次へ',showPrev=id>0;this.steps[id]={$element:$(item.selector),content:mustache.render(this.contentTemplate,{title:item.title,description:item.description,buttonLabel:buttonLabel,showPrev:showPrev})};};return Tour;});;define('VisualEditorTourExperimentConfig',[],function(){'use strict';return{'en':[{selector:'#WikiaArticle',placement:'top',title:'Write content',description:'Share your knowledge with the Community! This space is yours: write, fix typos, '+'add links. Make this article better with each edit!'},{selector:'.oo-ui-icon-link',placement:'bottom',title:'Add links',description:'Highlight a text you want to add link to. You can now write the name of the wiki page '+'you want the link to point at. Remember that you can always remove a link, by clicking on ‘remove the '+'link’ button after highlighting the text.'},{selector:'.oo-ui-icon-video',placement:'right',title:'Add Video',description:'Upload videos to a specified place in the article. Search for a video already present on '+'this Wiki or provide an URL from such sources as YouTube, Vimeo or Dailymotion.'},{selector:'.oo-ui-icon-image',placement:'right',title:'Add Image',description:'Upload pictures to a specified place in the article. You will be able to change the size '+'of the element later.'},{selector:'.oo-ui-icon-gallery',placement:'right',title:'Add Gallery',description:'Choose from the photos uploaded to this Wiki and create a gallery.'},{selector:'.oo-ui-icon-bullet-list',placement:'right',title:'Bullet list and Numbered list',description:'Organize your text into neat lists. You can highlight a few paragraphs and insert a list '+'of your choice or simply insert a list and start typing. If you want to turn a list into a regular text'+', just unclick the selected list.'},{selector:'.oo-ui-labelElement.oo-ui-listToolGroup',placement:'bottom',title:'Add extra content',description:'Click ‘Insert’ to choose from a number of extra elements: Infobox, Template, Reference, '+'Reference List and Table.'},{selector:'.ve-ui-toolbar-saveButton',placement:'bottom',title:'Publish your edit',description:'After you’ve made your edit, save the changed article by clicking on ‘Save page’. Now you '+'can add a description of your changes for other users to read, but you don’t have to do that. Click '+'‘save’ and go ahead, make another page on this Wiki better!'}],'ja':[{selector:'#WikiaArticle',placement:'top',title:'コンテンツを作成',description:'あなたの知識をコミュニティと共有しよう！新しい書き込みや修正、リンクの追加など、どんどん編集して記事を盛り'+'上げましょう！'},{selector:'.oo-ui-icon-link',placement:'bottom',title:'リンクを追加',description:'リンクを追加したいテキストをハイライトしてください。リンク先にしたいWikiページの名前を直接入力できるように'+'なりました。テキストをハイライトした後でも、[リンクを削除]ボタンをクリックすればいつでも変更することができます！'},{selector:'.oo-ui-icon-video',placement:'right',title:'動画を追加',description:'記事内の特定箇所に動画をアップロードしましょう。現在のWikiページにすでに存在する動画を検索、もしくは'+'YouTube、Vimeo、DailymotionなどからURLを指定してください。'},{selector:'.oo-ui-icon-image',placement:'right',title:'画像を追加',description:'記事内の特定箇所に画像をアップロードしましょう。画像サイズは後から変更できます。'},{selector:'.oo-ui-icon-gallery',placement:'right',title:'ギャラリーを追加',description:'現在のWikiページにアップロードされた画像から選択してギャラリーを作成しましょう。'},{selector:'.oo-ui-icon-bullet-list',placement:'right',title:'箇条書きリストおよび番号付きリスト',description:'追加したテキストをリストに整理しましょう。文章をいくつかハイライトしてお好きなリストを挿入、もしくはリスト'+'をそのまま挿入して入力を開始してください。リストを通常のテキストに変換したい場合は、選択済みリストをアンクリックしましょう。'},{selector:'.oo-ui-labelElement.oo-ui-listToolGroup',placement:'bottom',title:'さらにコンテンツを追加',description:'[挿入]をクリックしてインフォボックス、テンプレート、レファレンス、レファレンスリスト、テーブルなど、追加の'+'要素を選択しましょう。'},{selector:'.ve-ui-toolbar-saveButton',placement:'bottom',title:'編集内容を公開',description:'編集が完了しましたら、[ページを保存]をクリックして記事の変更内容を保存してください。保存した後に他の'+'ユーザーが参照できるよう、変更内容の説明を追加することもできますが、必須ではありません。[保存]をクリックしてそのまま他の'+'Wikiページをさらに充実させましょう！'}],'es':[{selector:'#WikiaArticle',placement:'top',title:'Escribe contenido',description:'¡Comparte tu conocimiento con la comunidad! Este espacio es tuyo: escribe, arregla errores '+'ortográficos, añade enlaces. ¡Haz que esta página sea mejor con cada edición!'},{selector:'.oo-ui-icon-link',placement:'bottom',title:'Añade enlaces',description:"Resalta un texto al cual quieras añadir un enlace. Ahora puedes escribir el nombre de la página "+"a la quieres dirigir. Recuerda que puedes remover un enlace haciendo clic en el botón 'Eliminar' luego de haber "+"resaltado el texto. "},{selector:'.oo-ui-icon-video',placement:'right',title:'Añade videos',description:'Sube videos a un espacio específico dentro de la página. Busca por un video que ya se encuentre '+'en la comunidad o coloca enlaces de sitios como YouTube, Vimeo o Dailymotion.'},{selector:'.oo-ui-icon-image',placement:'right',title:'Añade imágenes',description:'Sube imágenes a un espacio específico dentro de la página. Luego de subirlo tendrás la '+'posibilidad de cambiar el tamaño.'},{selector:'.oo-ui-icon-gallery',placement:'right',title:'Añade galerías',description:'Elige entre las imágenes subidas en esta comunidad para crear una galería.'},{selector:'.oo-ui-icon-bullet-list',placement:'right',title:'Lista de viñetas y número',description:'Organiza tu texto con una lista. Puedes resaltar algunos párrafos e inserta una lista de tu '+'elección o simplemente insertar una lista y empezar a escribir. Si quieres convertir la lista en un texto '+'regular, simplemente haz clic en la lista seleccionada anteriormente.'},{selector:'.oo-ui-labelElement.oo-ui-listToolGroup',placement:'bottom',title:'Añade contenido extra',description:"Haz clic en 'Insertar' para elegir de un número de elementos extras: infobox, plantilla, "+"básica, lista de referencias y tabla."},{selector:'.ve-ui-toolbar-saveButton',placement:'bottom',title:'Publica tu edición',description:"Luego de haber hecho tu edición, guarda los cambios hechos en la página haciendo clic en "+"'Guardar página'. Ahora puedes añadir una descripcion a la edición para que otros usuarios sepan que hiciste, "+"pero no es necesario. Haz clic en 'Guardar página' y busca otra página que necesite ser mejorada."}],'de':[{selector:'#WikiaArticle',placement:'top',title:'Inhalte verfassen',description:'Teile deine Weisheit mit der Community! Du kannst hier schreiben, Grammatik korrigieren und '+'Links hinzufügen. Der Artikel wird mit jeder Bearbeitung besser! '},{selector:'.oo-ui-icon-link',placement:'bottom',title:'Links hinzufügen',description:"Markiere den Text, dem du einem Link hinzufügen willst. Danach kannst du den Namen der Community "+"einfügen, zu der der Link führen soll. Der Link kann jederzeit wieder entfernt werden, wenn du nach dem "+"Markieren des Textes auf die 'Link entfernen' Schaltfläche klickst."},{selector:'.oo-ui-icon-video',placement:'right',title:'Video hinzufügen',description:'Hier kannst du ein Video an einem bestimmten Platz im Artikel einfügen. Suche nach dem Video '+'in der Community, oder gib eine URL von Seiten wie Youtube, Vimeo oder Dailymotion an. '},{selector:'.oo-ui-icon-image',placement:'right',title:'Bild hinzufügen',description:'Lade ein Bild hoch, um es auf einem bestimmten Platz im Artikel einzufügen. Danach kannst '+'du die Größe des Elements verändern. '},{selector:'.oo-ui-icon-gallery',placement:'right',title:'Galerie einfügen',description:'Du kannst aus den bereits in der Community vorhandenen Bilder auswählen und eine Galerie '+'damit erstellen. '},{selector:'.oo-ui-icon-bullet-list',placement:'right',title:'Aufzählung und Nummerierung',description:'Ordne deinen Text in Listen. Du kannst ganze Absätze hervorheben und eine Liste deiner Wahl einfügen. '+'Du kannst auch einfach eine Liste wählen und anfangen zu schreiben. Wenn du eine Liste in einfachen Text '+'zurückverwandeln willst, dann klicke einfach auf die gewählte Liste. '},{selector:'.oo-ui-labelElement.oo-ui-listToolGroup',placement:'bottom',title:'Zusätzlichen Inhalt erstellen',description:"Klicke auf 'Einfügen' um aus einer Reihe von Elementen zu wählen: Infobox, Vorlage, "+"Referenz, Referenzliste und Tabelle. "},{selector:'.ve-ui-toolbar-saveButton',placement:'bottom',title:'Deinen Beitrag veröffentlichen',description:"Nachdem du deinen Beitrag verfasst hast, kannst du den Artikel speichern, indem du auf "+"'Vorschau' klickst. Du hast dort die Möglichkeit eine Zusammenfassung deiner Bearbeitung zu hinterlassen. "+"Andere Benutzer können so sehen was du bearbeitet hast. Dies ist aber keine Pflicht. Klick auf "+"'Seite speichern' und verbessere eine weitere Seite in der Community! "}]};});;define('VisualEditorTourExperimentInit',['jquery','VisualEditorTourExperiment','VisualEditorTourExperimentConfig','wikia.abTest','ext.wikia.spitfires.experiments.tracker'],function($,VETour,veTourConfig,abTest,tracker){'use strict';var experimentName='contribution-experiments';function init(){var lang=mw.config.get('wgUserLanguage');if(isEnabled()){clearEntrypointPopover();(new VETour(veTourConfig[lang])).start();}}
function isEnabled(){var enable=isAllowedCommunity();if(mw.config.get('wgUserName')!=null){enable=enable&&isUserLanguagePreferenceJapanese()&&isUserwithoutedit();}
return enable&&!$.cookie('vetourdisabled');}
function trackPublish(){var enable=isAllowedCommunity();if(mw.config.get('wgUserName')!=null){enable=enable&&isUserLanguagePreferenceJapanese()&&isUserwithoutedit();}
if(enable){tracker.trackVerboseSuccess(experimentName,'publish');}}
function clearEntrypointPopover(){$('#ca-ve-edit').popover('destroy');}
function isAllowedCommunity(){var allowedLanguages=['ja'];return allowedLanguages.indexOf(mw.config.get('wgContentLanguage'))>-1;}
function isUserwithoutedit(){return $.cookie('userwithoutedit');}
function isUserLanguagePreferenceJapanese(){return mw.config.get('wgUserLanguage')==='ja';}
return{init:init,isEnabled:isEnabled,trackPublish:trackPublish};});;require(['jquery','mw','VisualEditorTourExperimentInit','ext.wikia.spitfires.experiments.tracker'],function($,mw,veTourInit,tracker){'use strict';var EXPERIMENT_NAME='contribution-experiments';function initEntry(){var $editButton=$('#ca-ve-edit');if(veTourInit.isEnabled()&&mw.config.get('wgNamespaceNumber')===0&&mw.config.get('wgVisualEditorPreferred')){if(mw.config.get('wgUserLanguage')==='ja'){$editButton.popover({content:'<div class="ve-tour-experiment">'+'<div class="close"></div>'+'<h2>編集モードを開く</h2>'+'<p>「編集」ボタンをクリックすると編集モードを開始し、記事が掲載されているページにコンテンツやメディアを追加する'+'ことができます。</p>'+'<nav class="nav-buttons"><button class="ve-tour-next">次へ</button></nav>'+'</div>',html:true,placement:'right',trigger:'manual'});}else{$editButton.popover({content:'<div class="ve-tour-experiment">'+'<div class="close"></div>'+'<h2>Enter edit mode</h2>'+'<p>Click on the Edit button to go into edit mode - there you will be able to add content '+'and media to an article page.</p>'+'<nav class="nav-buttons"><button class="ve-tour-next">Next</button></nav>'+'</div>',html:true,placement:'right',trigger:'manual'});}
$editButton.popover('show');$('.ve-tour-next').click(startTour.bind(this,$editButton));$('.ve-tour-experiment .close').click(close.bind(this,$editButton));tracker.trackVerboseImpression(EXPERIMENT_NAME,'tour-step-article-entry-point');}}
function startTour($editButton){$editButton.click();$editButton.popover('destroy');tracker.trackVerboseClick(EXPERIMENT_NAME,'edit-entry-point');}
function close($element){$.cookie('vetourdisabled',1,{expires:30,path:mw.config.get('wgCookiePath'),domain:mw.config.get('wgCookieDomain')});$element.popover('destroy');tracker.trackVerboseClick(EXPERIMENT_NAME,'close-article-entry-point');}
$(initEntry);});;